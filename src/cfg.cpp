/** 
 * @file cfg.cpp
 * @author Litvinova Alina
 */
//-------------------------------------------------------------------------------------------------
#include <fstream>
//-------------------------------------------------------------------------------------------------
#include <boost/property_tree/ini_parser.hpp>
//-------------------------------------------------------------------------------------------------
#include "cfg.hpp"
//-------------------------------------------------------------------------------------------------
namespace wapstart {
  Config::Config() {}
  //-----------------------------------------------------------------------------------------------
  Config::Config(const std::string &path): path_(path) { reload(); }
  //-----------------------------------------------------------------------------------------------
  void Config::load(const std::string &path) { path_ = path; reload(); }
  //-----------------------------------------------------------------------------------------------
  void Config::reload() 
  {
    std::ifstream stream(path_.c_str());
    if(stream) {
      load(stream);
    }
    else {
      throw file_not_found() << file_not_found::name(path_);
    }
  }
  //-----------------------------------------------------------------------------------------------
  void Config::load(stream_type &stream)
  {
    boost::property_tree::read_ini(stream, tree_);
  }
  //-----------------------------------------------------------------------------------------------
  Config::log_level_type Config::log_level() const 
  {
    return LogLevel::text2level(tree_.get<std::string>("general.log_level", "DEBUG"));
  }
  //-----------------------------------------------------------------------------------------------
} // namespace SU13
//-------------------------------------------------------------------------------------------------



